<div class="user-profile-container">
  <!-- Botón de perfil de usuario -->
  <div class="profile-button" (click)="toggleProfileMenu()" *ngIf="account">
    <div class="avatar-placeholder">
      <span class="avatar-icon">👤</span>
    </div>
    <div class="user-info">
      <div class="user-address">{{ account | slice:0:6 }}...{{ account | slice:-4 }}</div>
      <div class="user-role">{{ isAdmin ? 'Administrador' : 'Cliente' }}</div>
    </div>
    <div class="dropdown-arrow">▼</div>
  </div>

  <!-- Botón de conexión si no hay cuenta -->
  <button *ngIf="!account" (click)="connect()" class="btn btn-primary connect-button">
    <span class="btn-icon">🔗</span>
    <span class="btn-text">Conectar MetaMask</span>
  </button>

  <!-- Menú desplegable de perfil -->
  <div class="profile-dropdown" *ngIf="showProfileMenu && account">
    <div class="dropdown-header">
      <div class="header-avatar">
        <span class="avatar-icon">👤</span>
      </div>
      <div class="header-info">
        <div class="header-address">{{ account | slice:0:12 }}...{{ account | slice:-4 }}</div>
        <div class="header-role">{{ isAdmin ? 'Administrador' : 'Cliente' }}</div>
      </div>
    </div>

    <div class="dropdown-divider"></div>

    <div class="dropdown-section">
      <div class="section-title">Saldo</div>
      <div class="balance-display">
        <span class="balance-amount">{{ balance }} ETH</span>
      </div>
    </div>

    <div class="dropdown-divider"></div>

    <div class="dropdown-section">
      <div class="section-title">Información de conexión</div>
      <div class="connection-info">
        <div class="info-item">
          <span class="info-label">Red:</span>
          <span class="info-value">{{ getNetworkName(chainId!) }}</span>
        </div>
        <div class="info-item">
          <span class="info-label">Estado:</span>
          <span class="info-value status-connected">Conectado</span>
        </div>
      </div>
    </div>

    <div class="dropdown-divider"></div>

    <div class="dropdown-section">
      <div class="section-title">Cambiar Red</div>
      <div class="network-switcher">
        <button (click)="switchToNetwork('holesky')" class="network-option" [class.active]="chainId === '0x4268'">
          <span class="network-icon">⛓️</span>
          <span class="network-name">Holešky</span>
        </button>
        <button (click)="switchToNetwork('sepolia')" class="network-option" [class.active]="chainId === '0xaa36a7'">
          <span class="network-icon">⛓️</span>
          <span class="network-name">Sepolia</span>
        </button>
      </div>
    </div>

    <div class="dropdown-divider"></div>

    <div class="dropdown-section">
      <div class="section-title">Acciones rápidas</div>
      <div class="quick-actions">
        <button (click)="navigateToProfile()" class="dropdown-item">
          <span class="item-icon">👤</span>
          <span class="item-text">Mi Perfil</span>
        </button>
        
        <button *ngIf="!isAdmin" (click)="navigateToRequestLoan()" class="dropdown-item">
          <span class="item-icon">💰</span>
          <span class="item-text">Solicitar Préstamo</span>
        </button>
        
        <button *ngIf="!isAdmin" (click)="navigateToLoans()" class="dropdown-item">
          <span class="item-icon">📊</span>
          <span class="item-text">Mis Préstamos</span>
        </button>
        
        <button (click)="openBlockchainExplorer()" class="dropdown-item transactions-item">
          <span class="item-icon">🔗</span>
          <span class="item-text">Ver Transacciones</span>
        </button>
        
        <button *ngIf="isAdmin" (click)="navigateToAdmin()" class="dropdown-item">
          <span class="item-icon">👑</span>
          <span class="item-text">Panel de Administración</span>
        </button>
      </div>
    </div>

    <div class="dropdown-divider"></div>

    <button (click)="disconnect()" class="dropdown-item logout-item">
      <span class="item-icon">🔌</span>
      <span class="item-text">Desconectar Wallet</span>
    </button>
  </div>
</div>